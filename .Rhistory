geom_text(aes(label = label), data = label, vjust = "top", hjust = "right")
p
, aes(counts, fill = cut(counts, 5))) +
theme_minimal() +
labs(x = "Number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(aes(label = label), data = label, vjust = "top", hjust = "right")
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(aes(label = label), data = label, vjust = "top", hjust = "right")
p
p<- ggplot(counts, aes(counts, fill = cut(counts, 5))) +
geom_histogram(aes(y = (..count..)/sum(..count..)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))
p
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))
p
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..)),show.legend = FALSE,
fill = cut(counts, 5)) +
theme_minimal() +
labs(x = "Number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..)),show.legend = FALSE,
fill = cut(counts$counts, 5)) +
theme_minimal() +
labs(x = "Number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))
p
counts$counts
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))
p
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = "texT",
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))
p
length(counts$counts)
state
length(state$Count)
paste0("N= ",length(counts$counts), "\n Species= ",
length(state$Count)
)
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N= ",length(counts$counts), "\n Species= ",
length(state$Count)
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))
p
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts), "\n Species=",
length(state$Count), "\n Median=", median(counts$counts),
"\n Mean=", mean(counts$counts),
"\n Min=", min(counts$counts),
"\n Max=", max(counts$counts)
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))
p
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts), "\n Species=",
length(state$Count), "\n Median=", median(counts$counts),
"\n Mean=", mean(counts$counts),
"\n Min=", min(counts$counts),
"\n Max=", max(counts$counts)
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))
p
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))+
theme(axis.text = element_text(size = 15))
p
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText))+
theme(axis.text = element_text(size = 2))
p
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=10)
p
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=2)
p
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts), "\n Species=",
length(state$Count), "\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Minimum=", min(counts$counts),
"\n Maximum=", max(counts$counts)
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts), "\n Species=",
length(state$Count), "\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Mean=", round(getmode(counts$counts)),
"\n Minimum=", min(counts$counts),
"\n Maximum=", max(counts$counts)
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts), "\n Species=",
length(state$Count), "\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Mode=", round(getmode(counts$counts)),
"\n Minimum=", min(counts$counts),
"\n Maximum=", max(counts$counts)
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
quantile(counts$counts)
quantile(counts$counts)[2,4]
quantile(counts$counts)[c(2,4)]
paste0("N=",length(counts$counts), "\n Species=",
length(state$Count), "\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Mode=", round(getmode(counts$counts)),
"\n Q2/Q3=", quantile(counts$counts)[c(2,4)],
"\n Minimum=", min(counts$counts),
"\n Maximum=", max(counts$counts)
)
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts), "\n Species=",
length(state$Count), "\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Mode=", round(getmode(counts$counts)),
"\n Q2/Q3=", paste0(quantile(counts$counts)[c(2,4)], collapse = "/"),
"\n Minimum=", min(counts$counts),
"\n Maximum=", max(counts$counts)
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts), "\n Species=",
length(state$Count), "\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Mode=", round(getmode(counts$counts)),
"\n Quantile2/3=", paste0(quantile(counts$counts)[c(2,4)], collapse = "/"),
"\n Minimum=", min(counts$counts),
"\n Maximum=", max(counts$counts)
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts), "\n Species=",
length(state$Count), "\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Mode=", round(getmode(counts$counts)),
"\n [25-75%]=", paste0(quantile(counts$counts)[c(2,4)], collapse = "/"),
"\n Minimum=", min(counts$counts),
"\n Maximum=", max(counts$counts)
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts),
"\n Species=", length(state$Count),
"\n [25-75%]=", paste0(quantile(counts$counts)[c(2,4)], collapse = "/"),
"\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Mode=", round(getmode(counts$counts)),
"\n Minimum=", min(counts$counts),
"\n Maximum=", max(counts$counts)
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts),
"\n Species=", length(state$Count),
"\n [25-75%]=", paste0(quantile(counts$counts)[c(2,4)], collapse = "/"),
"\n Range=", paste0(min(counts$counts),max(counts$counts)  , collapse = "/"),
"\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Mode=", round(getmode(counts$counts))
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts),
"\n Species=", length(state$Count),
"\n [0-100%]=", paste0(min(counts$counts),max(counts$counts)  , collapse = "/"),
"\n [25-75%]=", paste0(quantile(counts$counts)[c(2,4)], collapse = "/"),
"\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Mode=", round(getmode(counts$counts))
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
paste0(min(counts$counts),max(counts$counts), collapse = "/")
max(counts$counts)
min(counts$counts)
paste0(min(counts$counts),max(counts$counts), collapse = "/")
paste0(min(counts$counts),max(counts$counts), collapse = "-")
paste0(min(counts$counts),"-",max(counts$counts))
annotations <- data.frame(
xpos = Inf,
ypos =  Inf,
annotateText = paste0("N=",length(counts$counts),
"\n Species=", length(state$Count),
"\n [0-100%]=", paste0(min(counts$counts),"-",max(counts$counts)),
"\n [25-75%]=", paste0(quantile(counts$counts)[c(2,4)], collapse = "-"),
"\n Median=", round(median(counts$counts)),
"\n Mean=", round(mean(counts$counts)),
"\n Mode=", round(getmode(counts$counts))
),
hjustvar = 1 ,
vjustvar = 1)
p<- ggplot(counts, aes(counts)) +
geom_histogram(aes(y = (..count..)/sum(..count..),
fill = cut(counts, 5)),show.legend = FALSE) +
theme_minimal() +
labs(x = "Haploid number (n)", y = "Frequency")+
scale_fill_discrete(h = c(180, 360), c = 150, l = 80)+
geom_text(data=annotations,aes(x=xpos,y=ypos,hjust=hjustvar,vjust=vjustvar,label=annotateText),  size=3)
p
library(DT)
ACC<-read.csv('ACCDB_Dec2.csv')
colnames(ACC)
colnames(ACC)[c(9, 11)]
colnames(ACC)[c(9, 11)]<-c("2N", "N")
colnames(ACC)
colnames(ACC)[c(9, 11)]
colnames(ACC)
firstup <- function(x) {
substr(x, 1, 1) <- toupper(substr(x, 1, 1))
x
}
firstup(colnames(ACC))
colnames(ACC)<-firstup(colnames(ACC))
colnames(ACC)[c(7,9,11)]
ACC<-read.csv('ACCDB_Dec2.csv')
colnames(ACC)<-firstup(colnames(ACC))
colnames(ACC)[c(7,9,11)]<-c("Species","2N", "N")
colnames(ACC)
table<-read.csv("ACCDB_Dec2.csv")
phylum<-c( 'Acoela',
'Arthropoda',
'Brachiopoda',
'Bryozoa',
'Chaetognatha',
'Chordata',
'Cnidaria',
'Ctenophora',
'Echinodermata',
'Entoprocta',
'Gastrotricha',
'Gnathostomulida',
'Hemichordata',
'Kinorhyncha',
'Mollusca',
'Nematoda',
'Nematomorpha',
'Nemertea',
'Onychophora',
'Phoronida',
'Placozoa',
'Platyhelminthes',
'Porifera',
'Rotifera',
'Sipuncula',
'Tardigrada',
'Xenoturbellida')
setwd("~/MEGA/Projects/3_Chromosomal_Counts_Animals/Website_ACC_Macbook/ACC/_posts")
table<-read.csv("ACCDB_Dec2.csv")
phylum<-c( 'Acoela',
'Arthropoda',
'Brachiopoda',
'Bryozoa',
'Chaetognatha',
'Chordata',
'Cnidaria',
'Ctenophora',
'Echinodermata',
'Entoprocta',
'Gastrotricha',
'Gnathostomulida',
'Hemichordata',
'Kinorhyncha',
'Mollusca',
'Nematoda',
'Nematomorpha',
'Nemertea',
'Onychophora',
'Phoronida',
'Placozoa',
'Platyhelminthes',
'Porifera',
'Rotifera',
'Sipuncula',
'Tardigrada',
'Xenoturbellida')
phylum_richness<-c(
140,
1302809,
392,
6008,
170,
85423,
10203,
187,
7550,
171,
794,
97,
103,
196,
84977,
25033,
339,
1358,
183,
16,
1,
29487,
8659,
2049,
205,
1167,
2)
CCounts_phylum<- unlist(lapply(seq_along(phylum), function(x){
dim(table[na.omit(table$phylum == phylum[x]),])[1]
}))
df <- data.frame(
"Phylum" = phylum,
"Total richness" = phylum_richness,
'Species in ACC' = CCounts_phylum,
'Richness in ACC (%)' = round(CCounts_phylum/phylum_richness,3)*100,
"Curated" = c(F,T,F,T,T,T,T,F,T,T,F,F,F,F,T,T,T,T,F,T,F,T,T,T,T,F,F) ,
stringsAsFactors = FALSE
)
write.csv(df, "summary.release.Dec2.csv", row.names = F)
